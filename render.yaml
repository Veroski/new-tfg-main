databases:
  - name: colabo-prod-db
    databaseName: colabo_automation
    user: postgres_user
    plan: free

services:
  # -------- BACKEND (FastAPI) ----------
  - type: web
    name: backend
    env: docker
    plan: free
    dockerfilePath: backend/Dockerfile
    autoDeploy: true
    envVars:
      # Base de datos (Render la inyecta autom√°ticamente)
      - key: DB_URL
        fromDatabase:
          name: colabo-prod-db
          property: connectionString

      # --- Secretos y configuraci√≥n manual ---
      - key: TOKEN
        sync: false
      - key: CLIENT_ID
        sync: false
      - key: CLIENT_SECRET
        sync: false
      - key: REDIRECT_URI
        value: https://backend.onrender.com/auth/callback

      - key: APP_SECRET_KEY
        sync: false
      - key: HASH_SECRET_KEY
        sync: false

      - key: DRIVE_FOLDER_NAME
        value: ColaboAutomation
      - key: COLAB_URL
        value: https://colab.research.google.com/drive/XYZ
      - key: NOTEBOOK_ID
        value: XYZ

      - key: FRONTEND_URL
        value: https://frontend.onrender.com

  # -------- FRONTEND (Next.js) ----------
  - type: web
    name: frontend
    env: docker
    plan: free
    dockerfilePath: frontend/Dockerfile
    dockerContext: frontend           # üëà Esto s√≠ es v√°lido
    autoDeploy: true
    envVars:
      - key: NEXT_PUBLIC_BACKEND_URL
        value: https://backend.onrender.com
